name: âœ¨ Lint, Build & Test

on:
    push:
    pull_request:

env:
    CARGO_TERM_COLOR: always

jobs:
    build_and_test:
        name: âœ¨ Quality Check
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v6
              name: ğŸ“‚ Checkout
            # version 1.15.2 In this crazy system, hashes are the only way to pin dependencies
            - uses: actions-rust-lang/setup-rust-toolchain@ca4a6432af353637602348dec3df861ef02ed8a6
              name: âš™ï¸ Setup Rust
              with:
                  components: clippy, rustfmt
                  target: x86_64-unknown-linux-gnu
                  cache-all-crates: true
                  cache-workspace-crates: true

            - name: â¬‡ï¸ Install dependencies
              run: sudo apt-get update && sudo apt-get install -y libsdl2-dev

            - name: ğŸ—ï¸ Build
              run: cargo build --target=x86_64-unknown-linux-gnu

            - name: ğŸ§ª Test
              run: cargo test --target=x86_64-unknown-linux-gnu

            - name: ğŸ“ Clippy
              run: cargo clippy --all-targets --all-features --target=x86_64-unknown-linux-gnu
