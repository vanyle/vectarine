# TODO

- [ ] From lua, enable/disable gl_linear/gl_nearest when drawing images
- [ ] Add more room in the debug ui to show loading errors
- [ ] Fix image orientation issue
- [ ] Add debugger tab to inspect values of Lua Constants
- [ ] Add a unit API with proper coordinate management instead of V2.
- [ ] 'Screen' system (Menu, Settings, Game, Pause...)
- [ ] Project System in the editor
  - [ ] 'assets' should be 'gamedata'
  - [ ] Have a game.toml inside 'gamedata'. It is loaded first instead of game.lua
    - [ ] Manifest contains name of the game, logo and root source.
    - [ ] Until the first script is loaded (an update function is available in the lua env), a splash screen is displayed.
  - [ ] Open manifest in the editor from the file menu
  - [ ] Allow opening zips that are "compiled projects" (from the runtime)
  - [ ] Have an export feature in the editor to make zips
- [ ] Investigate how to have true interactive web documentation
  - [ ] Add a 'docs' emscripten target.
  - [ ] JavaScript API to interact with the runtime (in this 'docs' project)
  - [ ] Ability to switch projects and load resources from the JS
- [ ] Tiled parsing
  - [ ] Sprites as an asset class
  - [ ] Reading tiled files
- [ ] Aseprite support
- [ ] Potential performance improvements
  - [ ] No base64 for loading data on the web
  - [ ] Use rect_pack for texture atlases, text rendering instead of the naive way.
  - [ ] Use vec2 for drawing 2d shapes instead of vec3 (inside default shaders)
  - [ ] Check if StreamDraw / StaticDraw actually does something
- [ ] More complete Lua API
  - [ ] V3, V4
  - [ ] V4 is a color
  - [ ] Default values (if a color is nil, it is infered to be black)
  - [ ] noise function (open simplex, for v2, v3 and v4) and worley
- [ ] Make a game with it !!!
- [ ] Audio API
- [ ] Event system, part II
  - [ ] Add event channels (for you can have an on-hit event with per-entity filtering. Channels are strings with a hashmap lookup, they are cheap)
- [ ] Make errors inside Update spam less the console
  - [ ] When the same error happens in a row inside update, only print it once (same behavior as browsers)
- [ ] Modding API
  - [ ] Add a way to load scripts in a separate environment with a subset of available functions
  - [ ] Add a way to pass data to and from the sandbox
- [ ] The 3D API!!
  - [ ] See how Three.js does things.
  - [ ] Camera
  - [ ] Scene??
  - [ ] Geometries + Materials = Mesh
  - [ ] Lights and shadows (set a max number of lights to 20 in the API)
  - [ ] Drawing a depth buffer

# Done

- [x] Shader API
  - [x] Write the luau functions for the API
  - [x] Add a shader resource
  - [x] Set shader to canvas
- [x] Canvas API 'framebuffer'
  - [x] Write the luau functions for the API
  - [x] Write a framebuffer in glframebuffer (inspiration from glium / vectarine 1)
  - [x] Find a way to pass the canvas object to lua?
  - [x] Check for memory leaks when reloading.
- [x] Allow 'always on top' in the editor using a menu checkbox.
- [x] Always enable vsync
- [x] Implement the require typing technique
- [x] Console improvements
  - [x] Make it easy to print to the console from anywhere in the code
  - [x] Clear logs
  - [x] Better scrolling
  - [x] Verbosity (info/warn/error)
- [x] Event system, part I
  - [x] Add an event system to Lua
  - [x] Auto-unsubscribe on module reload.
  - [x] Add a console command event
  - [x] Add a resource loaded/reloaded event
  - [x] Add a mouse click / key down event
- [x] Lua API Reorg
  - [x] Organize functions in namespace better and use metamethods
  - [x] Compatible luau types and requires
  - [x] Add a results variable to `loadScript` to make it convinient to access module exports with types.
- [x] Resource update
  - [x] Move loading state management out of the individual resources
  - [x] Scripts are resources
  - [x] Prevent loading twice the same resource
  - [x] Check resource status from Lua (Loaded, Error, Loading, ...)
  - [x] Allow loading a script from Lua
- [x] More complete drawing API
  - [x] Draw portions of images (the super general case with 8 vec2 as arguments, so 16 floats)
  - [x] Arrows
  - [x] Polygons
- [x] Vector API for Lua
  - [x] Use V2 for all pairs of coordinate in APIs
- [x] Handle high DPI screens (MacOS...)
- [x] Fullscreen API
- [x] Allow window resizing and handle aspect ratios
  - [x] Draw text with proper aspect ratio
  - [x] Draw circle with proper aspect ratio
  - [x] Lua API to toggle resizable window
  - [x] Lua API to set window size
  - [x] Lua API to get screen size
- [x] Loading fonts and drawing text from lua code
  - [x] Draw text
  - [x] Measure text
- [x] Assets "resource" system
  - [x] Resource tab in editor
  - [x] Error system when asset fails to load
  - [x] Hot reloading for assets
- [x] Loading images and drawing them from lua code
- [x] Performance: Batch drawing implementation
- [x] Window size
- [x] Mouse input
- [x] Editor console
- [x] pthread support (requires rust nightly, but it works)
- [x] Setup the editor
  - [x] When no CLI arguments are passed, open the editor
  - [x] Show EGui widget in the editor
  - [x] Use OpenGL for quad drawing in the runtime
  - [x] Be able to load a game.lua file
- [x] Cross-platform keyboard input
  - [x] Access to keyboard from lua
- [x] Loading external files (like lua) from rust, for web.
  - [x] Call JS from rust
  - [x] Call rust from JS
  - [x] Calling async function from both platforms
  - [x] Reading a lua file
- [x] Properly manage the different build types (using cargo workspaces probably?)
  - [x] Make web build and native build work without config changes
- [x] Web build
- [x] Luau : hot reload for script
- [x] Luau (with a function to draw rects probably)
